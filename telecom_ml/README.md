# Телеком 

Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

### Описание услуг

Оператор предоставляет два основных типа услуг: 

1. Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.
2. Интернет. Подключение может быть двух типов: через телефонную линию (DSL*,* от англ. *digital subscriber line*, «цифровая абонентская линия») или оптоволоконный кабель (*Fiber optic*).  

Также доступны такие услуги:

- Интернет-безопасность: антивирус (*DeviceProtection*) и блокировка небезопасных сайтов (*OnlineSecurity*);
- Выделенная линия технической поддержки (*TechSupport*);
- Облачное хранилище файлов для резервного копирования данных (*OnlineBackup*);
- Стриминговое телевидение (*StreamingTV*) и каталог фильмов (*StreamingMovies*).

За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

### Описание данных

Данные состоят из файлов, полученных из разных источников:

- `contract.csv` — информация о договоре;
- `personal.csv` — персональные данные клиента;
- `internet.csv` — информация об интернет-услугах;
- `phone.csv` — информация об услугах телефонии.

Во всех файлах столбец `customerID` содержит код клиента.

Информация о договорах актуальна на 1 февраля 2020.

## Общий вывод

### Выполненные шаги

В ходе выполнения проекта выполнены следующие шаги:
  1. Объеденнены датафреймы и изученны данные, заполнены пропуски, создан целевой признак и синтезирован признак длительности контракта в днях  
  2. Визуализированы признаки и на их основе сделаны выводы о среднестатистическом клиенте 
  3. Изучена связь между признаками и на основе этого анализа удалены признаки total_charges и monthly_charges. Так же удалены даты и customer_id. Стандартезированны численные признаки и и закодированы категориальные.
  4. Обучены три модели RandomForest, LightGBM и Catboost. Лучше всего показала себя модель CatBoost. 
  
**Сравнение с первоначальным планом**
  
По сравнению с изначальным планом решено было не проводить анализ на выбросы в основном, потому, что на выведенных графиках небыло замечено большего количества аномалий и пиков. Более явная проверка на дубликаты не была произведена из-за отсутствия явной в этом необходимости. Так же в изначальный план не входило создание дополнитедьгых признаков,но после анализа данных было принято решение о создании признака duration.

### Трудности

Особые трудности у меня вызвал подбор признаков в частности после создания признака duration - длительность контракта, качество моделей значительно улучшилось. Так же определенные трудности вызвало принятие решения о том, какие признаки стоит удалить, а какие оставить.  Для решения этой проблемы был проделан анализ данных. В частности анализ на мультиколлинеарность.

### Ключевые шаги

1. **Создание дополнительных признаков** Именно создание дополнительного признака помогло улучшить метрику максимально
2. **Изучение связи между признаками** И удаление лишних помогло улучшить метрику.
3. **Обучение Моделей** и тщательный подбор гиперпараметров помог оптимизации показателей.

### Используемые признаки

 В ходе обучения моделей использовались следующие признаки:


    duration                                 float64
    paperless_billing_Yes                    float64
    payment_method_Credit card (automatic)   float64
    payment_method_Electronic check          float64
    payment_method_Mailed check              float64
    senior_citizen_1                         float64
    partner_Yes                              float64
    dependents_Yes                           float64
    internet_service_Fiber optic             float64
    internet_service_No                      float64
    online_security_Yes                      float64
    device_protection_Yes                    float64
    tech_support_Yes                         float64
    streaming_tv_Yes                         float64
    streaming_movies_Yes                     float64
    multiple_lines_Yes                       float64
    online_backup_Yes                        float64
    gender_Male                              float64
    type_One year                            float64                    
    type_Two year                            float64                                  

И целевой признак exited типа object

Названия признаков были преведены к snake_case, заполнены пропуски, численные признаки были стандартезированы с использованием minmax scaler, категориальные закодированы через One Hot Encoding. Так же признаки были проверены на мультиколлинеарность. Признак duration был синтезирован на основе позднее удаленных дат договоров.

### Итоовая модель

По итогам исследования лучше всех на тестовой выборке себя показала модель Catboost Со следующими гиперпараметрами:

  1. 'depth': 4,
  2. 'l2_leaf_reg': 1,
  3. 'learning_rate': 0.03,
  4. 'loss_function': 'Logloss'
  5.  random_state : 270323
  
Значение метрик на тестовой выборке :

 1. auc-roc 0.9339977081116477
 2. accuracy 0.8591709256104486
 
Хотя метрика roc-auc и больше подходит для оценки качества модели условному заказщику проще объяснить метрику точности.

Полученная модель соответствует требованиям задания.

## Стек данных

- Pandas
- Matplotlib
- LightGBM
- Catboost
- Sklearn
- Phik